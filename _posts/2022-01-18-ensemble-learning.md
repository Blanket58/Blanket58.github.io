---
layout: post
title: 集成学习
date: 2022-01-18
tag: Algorithms
katex: true
---

## 个体与集成

集成学习通过构建多个学习器来完成学习任务，先产生一组个体学习器，再用某种策略将它们结合起来。个体学习器通常由一个现有的学习算法从训练数据产生，例如C4.5决策树、BP神经网络等。

- 集成中只包含同种类型的个体学习器时，这样的集成是**同质**的，同质集成中的个体学习器称为基学习器；
- 集成也可以包含不同类型的个体学习器，例如同时包含决策树与神经网络，这样的集成是**异质**的，这时不再有基学习器的称呼。

<div class="mermaid">
graph LR
    个体学习器1 & 个体学习器2 & ... & 个体学习器T --> 结合模块 --> 输出;
</div>

集成学习通过将多个学习器进行结合，常可获得比单一学习器更好的泛化性能，对于弱学习器（泛化性能略优于随机猜测）尤为明显。但一般常识下，如果把好坏不等的东西掺杂在一起，那么通常结果会是比最坏的要好一些，比最好的要坏一些。考虑一个二分类的例子，集成学习的结果通过投票法产生，实际可能会产生以下三种情况。

- 集成提升性能

|       | 测试例1 | 测试例2 | 测试例3 |
| :---: | :-----: | :-----: | :-----: |
| $h_1$ |    √    |    √    |    ×    |
| $h_2$ |    ×    |    √    |    √    |
| $h_3$ |    √    |    ×    |    √    |
| 集成  |    √    |    √    |    √    |

- 集成不起作用

|       | 测试例1 | 测试例2 | 测试例3 |
| :---: | :-----: | :-----: | :-----: |
| $h_1$ |    √    |    √    |    ×    |
| $h_2$ |    √    |    √    |    ×    |
| $h_3$ |    √    |    √    |    ×    |
| 集成  |    √    |    √    |    ×    |

- 集成起负作用

|       | 测试例1 | 测试例2 | 测试例3 |
| :---: | :-----: | :-----: | :-----: |
| $h_1$ |    √    |    ×    |    ×    |
| $h_2$ |    ×    |    √    |    ×    |
| $h_3$ |    ×    |    ×    |    √    |
| 集成  |    ×    |    ×    |    ×    |

于是我们可以得出结论：**想要获得泛化性能好的集成，每个个体学习器应该要有一定的准确性，同时学习器之间要存在差异。**对于一个二分类问题$y \in \{-1, +1\}$和真实函数$f$，假定基分类器的错误率为$\epsilon$，即对每个基分类器$h_i$有

$$
P(h_i(x) \neq f(x)) = \epsilon
$$

假设集成通过简单投票法结合T个基分类器，集成的分类结果为

$$
H(x) = sign \Bigg( \sum_{i=1}^T h_i(x) \Bigg)
$$

最多k个基分类器正确的概率为

$$
P(H(T) \leq k) = \sum_{i=0}^k C_T^i (1 - \epsilon)^i \epsilon^{T-i}
$$

其中$H(T)$表示T个基分类器中分类正确的个数。对于$\delta > 0$，$k = (1 - \epsilon - \delta)T$，有[Hoeffding不等式](https://en.m.wikipedia.org/wiki/Hoeffding%27s_inequality)

$$
\begin{aligned}
P(H(T) \leq (1 - \epsilon - \delta)T) &= P(\frac {H(T)} T - (1 - \epsilon) \leq - \delta) \\
&\leq \exp(-2 \delta^2 T)
\end{aligned}
$$

若有超过半数的基分类器错误，则集成分类就错误，此时的概率为

$$
P(H(x) \neq f(x)) = P(H(T) \leq \frac T 2) = \sum_{i=0}^{\lfloor T/2 \rfloor} C_T^i (1 - \epsilon)^i \epsilon^{T-i}
$$

对应着$k = \frac T 2$，$\delta = \frac 1 2 - \epsilon$，于是

$$
P(H(x) \neq f(x)) \leq \exp{\Bigg(-\frac 1 2 T (1 - 2 \epsilon) ^2\Bigg)}
$$
